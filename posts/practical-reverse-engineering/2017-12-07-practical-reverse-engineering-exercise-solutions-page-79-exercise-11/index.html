<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11 - soffensive blog</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/">
<meta property="og:site_name" content="soffensive blog"><meta property="og:title" content="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11"><meta property="og:description" content="Exercise 11 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called mystery11 - the last exercise of the ARM chapter:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 01: 010185B0 mystery11 02: 010185B0 2D E9 F8 4F PUSH.W {R3–R11,LR} 03: 010185B4 0D F2 20 0B ADDW R11, SP, #0x20 04: 010185B8 B0 F9 5A 30 LDRSH.W R3, [R0,#0x5A] 05: 010185BC 07 46 MOV R7, R0 06: 010185BE 90 46 MOV R8, R2 07: 010185C0 00 EB 83 03 ADD.W R3, R0, R3,LSL#2 08: 010185C4 D3 F8 84 A0 LDR.W R10, [R3,#0x84] 09: 010185C8 7B 8F LDRH R3, [R7,#0x3A] 10: 010185CA 89 46 MOV R9, R1 11: 010185CC CB B9 CBNZ R3, loc_1018602 12: 010185CE B0 F9 5A 40 LDRSH.W R4, [R0,#0x5A] 13: 010185D2 17 F1 20 02 ADDS.W R2, R7, #0x20 14: 010185D6 00 EB 44 03 ADD.W R3, R0, R4,LSL#1 15: 010185DA B3 F8 5C 50 LDRH.W R5, [R3,#0x5C] 16: 010185DE 00 EB 84 03 ADD.W R3, R0, R4,LSL#2 17: 010185E2 D3 F8 84 00 LDR.W R0, [R3,#0x84] 18: 010185E6 83 89 LDRH R3, [R0,#0xC] 19: 010185E8 06 6C LDR R6, [R0,#0x40] 20: 010185EA 03 EB 45 03 ADD.W R3, R3, R5,LSL#1 21: 010185EE 9B 19 ADDS R3, R3, R6 22: 010185F0 1C 78 LDRB R4, [R3] 23: 010185F2 5B 78 LDRB R3, [R3,#1] 24: 010185F4 43 EA 04 24 ORR.W R4, R3, R4,LSL#8 25: 010185F8 43 8A LDRH R3, [R0,#0x12] 26: 010185FA 23 40 ANDS R3, R4 27: 010185FC 99 19 ADDS R1, R3, R6 28: 010185FE FD F7 8D FF BL sub_101651C 29: 01018602 loc_1018602 30: 01018602 BA 8E LDRH R2, [R7,#0x34] 31: 01018604 BB 6A LDR R3, [R7,#0x28] 32: 01018606 D0 18 ADDS R0, R2, R3 33: 01018608 9A F8 02 30 LDRB.W R3, [R10,#2] 34: 0101860C 0B B1 CBZ R3, loc_1018612 35: 0101860E 00 22 MOVS R2, #0 36: 01018610 00 E0 B loc_1018614 37: 01018612 loc_1018612 38: 01018612 3A 6A LDR R2, [R7,#0x20] 39: 01018614 loc_1018614 40: 01018614 FB 8E LDRH R3, [R7,#0x36] 41: 01018616 B8 F1 00 0F CMP.W R8, #0 42: 0101861A 01 D0 BEQ loc_1018620 43: 0101861C 80 18 ADDS R0, R0, R2 44: 0101861E 9B 1A SUBS R3, R3, R2 45: 01018620 loc_1018620 46: 01018620 C9 F8 00 30 STR.W R3, [R9] 47: 01018624 BD E8 F8 8F POP.W {R3–R11,PC} 48: 01018624 ; End of function mystery11 According to the exercise description, the called subroutine sub_101651C in line 28 takes three arguments and does not return anything. Thus, we know the registers R0, R1 and R2 are prepared and passed to the function."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-12-07T10:29:00-08:00"><meta property="article:modified_time" content="2017-12-07T10:29:00-08:00"><meta property="article:tag" content="ARM"><meta property="article:tag" content="Practical Reverse Engineering"><meta name=twitter:card content="summary"><meta name=twitter:title content="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11"><meta name=twitter:description content="Exercise 11 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called mystery11 - the last exercise of the ARM chapter:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 01: 010185B0 mystery11 02: 010185B0 2D E9 F8 4F PUSH.W {R3–R11,LR} 03: 010185B4 0D F2 20 0B ADDW R11, SP, #0x20 04: 010185B8 B0 F9 5A 30 LDRSH.W R3, [R0,#0x5A] 05: 010185BC 07 46 MOV R7, R0 06: 010185BE 90 46 MOV R8, R2 07: 010185C0 00 EB 83 03 ADD.W R3, R0, R3,LSL#2 08: 010185C4 D3 F8 84 A0 LDR.W R10, [R3,#0x84] 09: 010185C8 7B 8F LDRH R3, [R7,#0x3A] 10: 010185CA 89 46 MOV R9, R1 11: 010185CC CB B9 CBNZ R3, loc_1018602 12: 010185CE B0 F9 5A 40 LDRSH.W R4, [R0,#0x5A] 13: 010185D2 17 F1 20 02 ADDS.W R2, R7, #0x20 14: 010185D6 00 EB 44 03 ADD.W R3, R0, R4,LSL#1 15: 010185DA B3 F8 5C 50 LDRH.W R5, [R3,#0x5C] 16: 010185DE 00 EB 84 03 ADD.W R3, R0, R4,LSL#2 17: 010185E2 D3 F8 84 00 LDR.W R0, [R3,#0x84] 18: 010185E6 83 89 LDRH R3, [R0,#0xC] 19: 010185E8 06 6C LDR R6, [R0,#0x40] 20: 010185EA 03 EB 45 03 ADD.W R3, R3, R5,LSL#1 21: 010185EE 9B 19 ADDS R3, R3, R6 22: 010185F0 1C 78 LDRB R4, [R3] 23: 010185F2 5B 78 LDRB R3, [R3,#1] 24: 010185F4 43 EA 04 24 ORR.W R4, R3, R4,LSL#8 25: 010185F8 43 8A LDRH R3, [R0,#0x12] 26: 010185FA 23 40 ANDS R3, R4 27: 010185FC 99 19 ADDS R1, R3, R6 28: 010185FE FD F7 8D FF BL sub_101651C 29: 01018602 loc_1018602 30: 01018602 BA 8E LDRH R2, [R7,#0x34] 31: 01018604 BB 6A LDR R3, [R7,#0x28] 32: 01018606 D0 18 ADDS R0, R2, R3 33: 01018608 9A F8 02 30 LDRB.W R3, [R10,#2] 34: 0101860C 0B B1 CBZ R3, loc_1018612 35: 0101860E 00 22 MOVS R2, #0 36: 01018610 00 E0 B loc_1018614 37: 01018612 loc_1018612 38: 01018612 3A 6A LDR R2, [R7,#0x20] 39: 01018614 loc_1018614 40: 01018614 FB 8E LDRH R3, [R7,#0x36] 41: 01018616 B8 F1 00 0F CMP.W R8, #0 42: 0101861A 01 D0 BEQ loc_1018620 43: 0101861C 80 18 ADDS R0, R0, R2 44: 0101861E 9B 1A SUBS R3, R3, R2 45: 01018620 loc_1018620 46: 01018620 C9 F8 00 30 STR.W R3, [R9] 47: 01018624 BD E8 F8 8F POP.W {R3–R11,PC} 48: 01018624 ; End of function mystery11 According to the exercise description, the called subroutine sub_101651C in line 28 takes three arguments and does not return anything. Thus, we know the registers R0, R1 and R2 are prepared and passed to the function."><meta name=twitter:site content="@evisneffos"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/><link rel=prev href=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-06-practical-reverse-engineering-exercise-solutions-page-79-exercise-10/><link rel=next href=https://soffensive.github.io/posts/ctf/2018-01-23-pwnable-kr-crypto1-challenge/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/soffensive.github.io\/posts\/practical-reverse-engineering\/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11\/"},"genre":"posts","keywords":"ARM, Practical Reverse Engineering","wordcount":2007,"url":"https:\/\/soffensive.github.io\/posts\/practical-reverse-engineering\/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11\/","datePublished":"2017-12-07T10:29:00-08:00","dateModified":"2017-12-07T10:29:00-08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"soffensive"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="soffensive blog">soffensive blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/soffensive title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><a class=menu-item href=https://twitter.com/evisneffos title=Twitter rel="noopener noreffer" target=_blank><i class='fab fa-twitter fa-fw'></i> </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="soffensive blog">soffensive blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/soffensive title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a class=menu-item href=https://twitter.com/evisneffos title=Twitter rel="noopener noreffer" target=_blank><i class='fab fa-twitter fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2017-12-07>2017-12-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2007 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;10 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><p>Exercise 11 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery11</code> - the last exercise of the ARM chapter:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span> <span class=err>010185</span><span class=nf>B0</span>             <span class=nv>mystery11</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>010185</span><span class=nf>B0</span> <span class=mi>2</span><span class=nv>D</span> <span class=nv>E9</span> <span class=nv>F8</span> <span class=mi>4</span><span class=nv>F</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R3</span><span class=err>–</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>010185</span><span class=nf>B4</span> <span class=mi>0</span><span class=nv>D</span> <span class=nv>F2</span> <span class=mi>20</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x20</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>010185</span><span class=nf>B8</span> <span class=nv>B0</span> <span class=nv>F9</span> <span class=mi>5</span><span class=nv>A</span> <span class=mi>30</span>   <span class=nv>LDRSH.W</span>  <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x5A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>010185</span><span class=nf>BC</span> <span class=mi>07</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R7</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>010185</span><span class=nf>BE</span> <span class=mi>90</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R8</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>010185</span><span class=nf>C0</span> <span class=mi>00</span> <span class=nv>EB</span> <span class=mi>83</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span><span class=nv>LSL#2</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>010185</span><span class=nf>C4</span> <span class=nv>D3</span> <span class=nv>F8</span> <span class=mi>84</span> <span class=nv>A0</span>   <span class=nv>LDR.W</span>    <span class=nv>R10</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mh>0x84</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>010185</span><span class=nf>C8</span> <span class=mi>7</span><span class=nv>B</span> <span class=mi>8</span><span class=nv>F</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x3A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>010185</span><span class=nf>CA</span> <span class=mi>89</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R9</span><span class=p>,</span> <span class=nv>R1</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>010185</span><span class=nf>CC</span> <span class=nv>CB</span> <span class=nv>B9</span>         <span class=nv>CBNZ</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>loc_1018602</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>010185</span><span class=nf>CE</span> <span class=nv>B0</span> <span class=nv>F9</span> <span class=mi>5</span><span class=nv>A</span> <span class=mi>40</span>   <span class=nv>LDRSH.W</span>  <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x5A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=err>010185</span><span class=nf>D2</span> <span class=mi>17</span> <span class=nv>F1</span> <span class=mi>20</span> <span class=mi>02</span>   <span class=nv>ADDS.W</span>   <span class=nv>R2</span><span class=p>,</span> <span class=nv>R7</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x20</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=err>010185</span><span class=nf>D6</span> <span class=mi>00</span> <span class=nv>EB</span> <span class=mi>44</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R4</span><span class=p>,</span><span class=nv>LSL#1</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>010185</span><span class=nf>DA</span> <span class=nv>B3</span> <span class=nv>F8</span> <span class=mi>5</span><span class=nv>C</span> <span class=mi>50</span>   <span class=nv>LDRH.W</span>   <span class=nv>R5</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mh>0x5C</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>010185</span><span class=nf>DE</span> <span class=mi>00</span> <span class=nv>EB</span> <span class=mi>84</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R4</span><span class=p>,</span><span class=nv>LSL#2</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>010185</span><span class=nf>E2</span> <span class=nv>D3</span> <span class=nv>F8</span> <span class=mi>84</span> <span class=mi>00</span>   <span class=nv>LDR.W</span>    <span class=nv>R0</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mh>0x84</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>18:</span> <span class=err>010185</span><span class=nf>E6</span> <span class=mi>83</span> <span class=mi>89</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0xC</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=err>010185</span><span class=nf>E8</span> <span class=mi>06</span> <span class=mi>6</span><span class=nv>C</span>         <span class=nv>LDR</span>      <span class=nv>R6</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>20:</span> <span class=err>010185</span><span class=nf>EA</span> <span class=mi>03</span> <span class=nv>EB</span> <span class=mi>45</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R5</span><span class=p>,</span><span class=nv>LSL#1</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=err>010185</span><span class=nf>EE</span> <span class=mi>9</span><span class=nv>B</span> <span class=mi>19</span>         <span class=nv>ADDS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R6</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>010185</span><span class=nf>F0</span> <span class=mi>1</span><span class=nv>C</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>010185</span><span class=nf>F2</span> <span class=mi>5</span><span class=nv>B</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=err>010185</span><span class=nf>F4</span> <span class=mi>43</span> <span class=nv>EA</span> <span class=mi>04</span> <span class=mi>24</span>   <span class=nv>ORR.W</span>    <span class=nv>R4</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R4</span><span class=p>,</span><span class=nv>LSL#8</span>
</span></span><span class=line><span class=cl><span class=err>25:</span> <span class=err>010185</span><span class=nf>F8</span> <span class=mi>43</span> <span class=mi>8</span><span class=nv>A</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x12</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>26:</span> <span class=err>010185</span><span class=nf>FA</span> <span class=mi>23</span> <span class=mi>40</span>         <span class=nv>ANDS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>27:</span> <span class=err>010185</span><span class=nf>FC</span> <span class=mi>99</span> <span class=mi>19</span>         <span class=nv>ADDS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R6</span>
</span></span><span class=line><span class=cl><span class=err>28:</span> <span class=err>010185</span><span class=nf>FE</span> <span class=nv>FD</span> <span class=nv>F7</span> <span class=mi>8</span><span class=nv>D</span> <span class=nv>FF</span>   <span class=nb>BL</span>       <span class=nv>sub_101651C</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>29:</span> <span class=err>01018602</span>      <span class=nf>loc_1018602</span>
</span></span><span class=line><span class=cl><span class=err>30:</span> <span class=err>01018602</span> <span class=nf>BA</span> <span class=mi>8</span><span class=nv>E</span>         <span class=nv>LDRH</span>     <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x34</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>31:</span> <span class=err>01018604</span> <span class=nf>BB</span> <span class=mi>6</span><span class=nv>A</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x28</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>32:</span> <span class=err>01018606</span> <span class=nf>D0</span> <span class=mi>18</span>         <span class=nv>ADDS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R2</span><span class=p>,</span> <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>33:</span> <span class=err>01018608</span> <span class=err>9</span><span class=nf>A</span> <span class=nv>F8</span> <span class=mi>02</span> <span class=mi>30</span>   <span class=nv>LDRB.W</span>   <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R10</span><span class=p>,</span><span class=err>#</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>34:</span> <span class=err>0101860</span><span class=nf>C</span> <span class=mb>0B</span> <span class=nv>B1</span>         <span class=nv>CBZ</span>      <span class=nv>R3</span><span class=p>,</span> <span class=nv>loc_1018612</span>
</span></span><span class=line><span class=cl><span class=err>35:</span> <span class=err>0101860</span><span class=nf>E</span> <span class=mi>00</span> <span class=mi>22</span>         <span class=nv>MOVS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>36:</span> <span class=err>01018610</span> <span class=err>00</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>loc_1018614</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>37:</span> <span class=err>01018612</span>      <span class=nf>loc_1018612</span>
</span></span><span class=line><span class=cl><span class=err>38:</span> <span class=err>01018612</span> <span class=err>3</span><span class=nf>A</span> <span class=mi>6</span><span class=nv>A</span>         <span class=nv>LDR</span>      <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x20</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>39:</span> <span class=err>01018614</span>      <span class=nf>loc_1018614</span>
</span></span><span class=line><span class=cl><span class=err>40:</span> <span class=err>01018614</span> <span class=nf>FB</span> <span class=mi>8</span><span class=nv>E</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x36</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>41:</span> <span class=err>01018616</span> <span class=nf>B8</span> <span class=nv>F1</span> <span class=mi>00</span> <span class=mi>0</span><span class=nv>F</span>   <span class=nv>CMP.W</span>    <span class=nv>R8</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>42:</span> <span class=err>0101861</span><span class=nf>A</span> <span class=mi>01</span> <span class=nv>D0</span>         <span class=nv>BEQ</span>      <span class=nv>loc_1018620</span>
</span></span><span class=line><span class=cl><span class=err>43:</span> <span class=err>0101861</span><span class=nf>C</span> <span class=mi>80</span> <span class=mi>18</span>         <span class=nv>ADDS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>44:</span> <span class=err>0101861</span><span class=nf>E</span> <span class=mi>9</span><span class=nv>B</span> <span class=mi>1</span><span class=nv>A</span>         <span class=nv>SUBS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>45:</span> <span class=err>01018620</span>      <span class=nf>loc_1018620</span>
</span></span><span class=line><span class=cl><span class=err>46:</span> <span class=err>01018620</span> <span class=nf>C9</span> <span class=nv>F8</span> <span class=mi>00</span> <span class=mi>30</span>   <span class=nv>STR.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R9</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>47:</span> <span class=err>01018624</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=nv>F8</span> <span class=mi>8</span><span class=nv>F</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R3</span><span class=err>–</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>48:</span> <span class=err>01018624</span>             <span class=c1>; End of function mystery11</span>
</span></span></code></pre></td></tr></table></div></div><p>According to the exercise description, the called subroutine <code>sub_101651C</code> in line 28 takes three arguments and does not return anything. Thus, we know the registers <code>R0</code>, <code>R1</code> and <code>R2</code> are prepared and passed to the function.</p><p>The function is executed in Thumb mode, as we can see from the different instructions having both a width of 16 and 32 bits. Furthermore, Thumb specific instructions such as <code>PUSH.W</code>, <code>POP.W</code> and <code>STR.W</code> are contained in the disassembly.</p><p>With regard to the instruction semantics, we shed light on the following examples:</p><ul><li><p><code>LDRSH.W R3, [R0,#0x5A]</code>: Load Signed Halfword Into Register. For the ARM architcture, a word is a 32-bit value and a half-word a 16-bit value. Thus, a signed 16-bit integer value (2 bytes) is loaded from the memory location <code>[R0 + 0x5A]</code> into <code>R3</code>.</p></li><li><p><code>LDRH R3, [R0,#0xC]</code>: Load Half Word Into Register. Slightly different than LDRSH, this instruction loads an unsigned 16-bit integer value into the destination register. In particular, it loads from memory at <code>[R0 + 0xC]</code> into register R3.</p></li><li><p><code>ADD.W R3, R0, R3,LSL#2</code>: This composition of arithmetic operations is equal to the following expression: <code>R3 = R0 + (R3 &lt;&lt; 2)</code></p></li><li><p><code>ORR.W R4, R3, R4,LSL#8</code>: This composition of logical operations is equal to the following expression: <code>R4 = R3 | (R4 &lt;&lt; 8)</code></p></li></ul><p>Let us know examine the data types of <code>mystery11</code>&rsquo;s arguments. <code>R0</code> seems to be a pointer to a data structure, as we are accessing its field member at offset <code>0x5A</code>. We create a provisional <code>unknownStruct1</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nl>unknownStruct1</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field5a_sint16</span><span class=p>;</span> <span class=c1>// 2 byte signed integer value (i.e. sint16) - line 4
</span></span></span></code></pre></td></tr></table></div></div><p><code>R1</code> is first accessed in line 10 and its value is copied into <code>R9</code>, which is  used in line 46 as a destination address for storing a 32 bit value. Thus, we assume it is a pointer as well to an unknown memory structure.</p><p>The third argument in <code>R2</code> is preserved in <code>R8</code> (line 6) and used for a check against zero (line 41). Hence, we assume it is a 32-bit unsigned integer.</p><p>As far as the return value is concerned, we notice the return register R0 is set either in line 32 or 43 before the function exits. In both cases, an addition is performed so we assume it is of type <code>uint32</code>.</p><p>Our first function prototype proposal:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>uint32</span> <span class=nf>mystery11</span> <span class=p>(</span><span class=n>unknownStruct1</span><span class=o>*</span> <span class=n>arg1</span><span class=p>,</span> <span class=kt>int</span><span class=o>*</span> <span class=n>arg2</span><span class=p>,</span> <span class=n>uint32</span> <span class=n>arg3</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Although the function contains no loops, the plethora of memory accesses does not permit us to reason about its functionality at a high level. Thus, we provide the first attempt to generate C code from the disassembly step-by-step along with the data structures:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nl>unknownStruct1</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field20_uint32</span><span class=p>;</span> <span class=c1>// unknown 4 byte value - line 38
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field28_uint32</span><span class=p>;</span> <span class=c1>// unknown 4 byte value - line 31
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field34_uint16</span><span class=p>;</span> <span class=c1>// unknown 2 byte value - line 30
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field36_uint16</span><span class=p>;</span> <span class=c1>// unknown 2 byte value - line 40
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field3a_uint16</span><span class=p>;</span> <span class=c1>// 2 byte unsigned integer - line 9
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field5a_sint16</span><span class=p>;</span> <span class=c1>// 2 byte signed integer value (i.e. sint16) - line 4
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>unknownStruct2</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field84_unknownstruct3_p</span><span class=p>;</span> <span class=c1>// pointer to an instance of unknownStruct3
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>unknownStruct3</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field02_c</span><span class=p>;</span> <span class=c1>// line 33
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field12_uint16</span><span class=p>;</span> <span class=c1>// line 25
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field0C_uint16</span><span class=p>;</span> <span class=c1>// line 18
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field40_p</span><span class=p>;</span> <span class=c1>// line 19 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>unknownStruct4</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field5c_uint16</span><span class=p>;</span> <span class=c1>// line 15
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>uint32</span> <span class=nf>mystery11</span> <span class=p>(</span><span class=n>unknownStruct1</span><span class=o>*</span> <span class=n>arg1</span><span class=p>,</span> <span class=kt>int</span><span class=o>*</span> <span class=n>arg2</span><span class=p>,</span> <span class=n>uint32</span> <span class=n>arg3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field5a_sint16</span><span class=p>;</span> <span class=c1>// line 4
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>unknownStruct1</span><span class=o>*</span> <span class=n>r7</span> <span class=o>=</span> <span class=n>arg1</span><span class=p>;</span> <span class=c1>// line 5
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>uint32</span> <span class=n>r8</span> <span class=o>=</span> <span class=n>arg3</span><span class=p>;</span> <span class=c1>// line 6
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>unknownStruct2</span><span class=o>*</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span> <span class=o>+</span> <span class=p>(</span><span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field5a_sint16</span> <span class=o>*</span> <span class=mi>4</span><span class=p>);</span> <span class=c1>// lines 4, 7
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>unknownStruct3</span><span class=o>*</span> <span class=n>r10</span> <span class=o>=</span> <span class=n>r3</span><span class=o>-&gt;</span><span class=n>field84_p</span><span class=p>;</span> <span class=c1>// line 8
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>uint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field3a_uint16</span><span class=p>;</span> <span class=c1>// line 9
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span><span class=o>*</span> <span class=n>r9</span> <span class=o>=</span> <span class=n>arg2</span><span class=p>;</span> <span class=c1>// line 10
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r3</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// line 11
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint32</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>arg1</span> <span class=o>+</span> <span class=mh>0x20</span><span class=p>;</span> <span class=c1>// line 13
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>sint16</span> <span class=n>r4</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field5a_sint16</span><span class=p>;</span> <span class=c1>// line 12
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>unknownStruct4</span><span class=o>*</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span> <span class=o>+</span> <span class=p>(</span><span class=n>r4</span> <span class=o>*</span> <span class=mi>2</span><span class=p>);</span> <span class=c1>// line 14
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint16</span> <span class=n>r5</span> <span class=o>=</span> <span class=n>r3</span><span class=o>-&gt;</span><span class=n>field5c_uint16</span><span class=p>;</span> <span class=c1>// line 15
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>unknownStruct2</span><span class=o>*</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span> <span class=o>+</span> <span class=p>(</span><span class=n>r4</span> <span class=o>*</span> <span class=mi>4</span><span class=p>);</span>  <span class=c1>// line 16 - Probably unknownStruct5 == unknownStruct2, since we access the same memory location as in line 7
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>unknownStruct3</span><span class=o>*</span> <span class=n>r0</span> <span class=o>=</span> <span class=n>r3</span><span class=o>-&gt;</span><span class=n>field84_p</span><span class=p>;</span> <span class=c1>// line 17 - strong similarity to line 8
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r0</span><span class=o>-&gt;</span><span class=n>field0C_uint16</span><span class=p>;</span> <span class=c1>// line 18
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span><span class=o>*</span> <span class=n>r6</span> <span class=o>=</span> <span class=n>r0</span><span class=o>-&gt;</span><span class=n>field40_p</span><span class=p>;</span> <span class=c1>// line 19  - this is most likely a pointer due to the subsequent address calculations
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint32</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r3</span> <span class=o>+</span> <span class=p>(</span><span class=n>r5</span> <span class=o>*</span> <span class=mi>2</span><span class=p>);</span> <span class=c1>// line 20
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>r3</span> <span class=o>=</span> <span class=n>r6</span> <span class=o>+</span> <span class=n>r3</span><span class=p>;</span> <span class=c1>// line 21
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>r4</span> <span class=o>=</span> <span class=n>r3</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span> <span class=c1>// line 22
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>char</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r3</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span> <span class=c1>// line 23 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>r4</span> <span class=o>=</span> <span class=n>r3</span> <span class=o>|</span> <span class=p>(</span><span class=n>r4</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>);</span> <span class=c1>// line 24 - we effectively obtain a 16-bit value by ORing two 8-bit values, where one was shifted 8 positions to the left
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r0</span><span class=o>-&gt;</span><span class=n>field12_uint16</span><span class=p>;</span> <span class=c1>// line 25
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>r3</span> <span class=o>=</span> <span class=n>r3</span> <span class=o>&amp;</span> <span class=n>r4</span><span class=p>;</span> <span class=c1>// line 26
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>r1</span> <span class=o>=</span> <span class=n>r6</span> <span class=o>+</span> <span class=n>r3</span><span class=p>;</span> <span class=c1>// line 27 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=nf>sub_101651C</span><span class=p>(</span><span class=n>r0</span><span class=p>,</span> <span class=n>r1</span><span class=p>,</span> <span class=n>r2</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>uint16</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field34_uint16</span><span class=p>;</span> <span class=c1>// line 30
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>uint32</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field28_uint32</span><span class=p>;</span> <span class=c1>// line 31
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>uint32</span> <span class=n>r0</span> <span class=o>=</span> <span class=n>r2</span> <span class=o>+</span> <span class=n>r3</span><span class=p>;</span> <span class=c1>// line 32
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r10</span><span class=o>-&gt;</span><span class=n>field02_c</span><span class=p>;</span> <span class=c1>// line 33
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r3</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// line 34
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>uint32</span> <span class=n>r2</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field20_uint32</span><span class=p>;</span> <span class=c1>// line 38
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>uint32</span> <span class=n>r2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// line 35
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>uint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field36_uint16</span><span class=p>;</span> <span class=c1>// line 40
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>arg3</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// lines 41,42
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>r0</span> <span class=o>=</span> <span class=n>r0</span> <span class=o>+</span> <span class=n>r2</span><span class=p>;</span> <span class=c1>// line 43
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>r3</span> <span class=o>=</span> <span class=n>r3</span> <span class=o>+</span> <span class=n>r2</span><span class=p>;</span> <span class=c1>// line 44
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>arg2</span> <span class=o>=</span> <span class=n>r3</span><span class=p>;</span> <span class=c1>// line 46
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>To be honest, this looks like a huge mess, but it is just our first attempt and we will try to refine the code and make it more readable.</p><p>Firstly, we follow the data flow from the end of the program to see what kind of value will be stored in the pointer arg2. We notice there can be at most a 32-bit value, so we change the data type of arg2 from <code>int*</code> to <code>uint32*</code>.</p><p>Secondly, we eliminate instructions that are either unnecessary or duplicated.</p><p>Thirdly, we try to minimize the number of C code by combining the load with the different arithmetic or comparison operations.</p><p>Fourthly, we try to give the variables more descriptive names. For instance, the third argument arg3 is only used to indicate or whether or not the addition in the last conditional block should be executed.</p><p>Therefore, we choose its name to be <code>performAddition</code>. The subroutine <code>sub_101651C</code> was named <code>perform_magic</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nl>unknownStruct1</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field20_uint32</span><span class=p>;</span> <span class=c1>// unknown 4 byte value - line 38
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field28_uint32</span><span class=p>;</span> <span class=c1>// unknown 4 byte value - line 31
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field34_uint16</span><span class=p>;</span> <span class=c1>// unknown 2 byte value - line 30
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field36_uint16</span><span class=p>;</span> <span class=c1>// unknown 2 byte value - line 40
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field3a_uint16</span><span class=p>;</span> <span class=c1>// 2 byte unsigned integer - line 9
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field5a_sint16</span><span class=p>;</span> <span class=c1>// 2 byte signed integer value (i.e. sint16) - line 4
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>unknownStruct2</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field84_unknownstruct3_p</span><span class=p>;</span> <span class=c1>// pointer to an instance of unknownStruct3
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>unknownStruct3</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field02_c</span><span class=p>;</span> <span class=c1>// line 33
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field12_uint16</span><span class=p>;</span> <span class=c1>// line 25
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field0C_uint16</span><span class=p>;</span> <span class=c1>// line 18
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>field40_p</span><span class=p>;</span> <span class=c1>// line 19 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>unknownStruct4</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>field5c_uint16</span><span class=p>;</span> <span class=c1>// line 15
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>uint32</span> <span class=nf>mystery11</span> <span class=p>(</span><span class=n>unknownStruct1</span><span class=o>*</span> <span class=n>unknownStruct1Ptr</span><span class=p>,</span> <span class=kt>int</span><span class=o>*</span> <span class=n>dest</span><span class=p>,</span> <span class=n>uint32</span> <span class=n>indicator</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>unknownStruct2</span><span class=o>*</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>unknownStruct1Ptr</span> <span class=o>+</span> <span class=p>(</span><span class=n>unknownStruct1Ptr</span><span class=o>-&gt;</span><span class=n>field5a_sint16</span> <span class=o>*</span> <span class=mi>4</span><span class=p>);</span> <span class=c1>// lines 4, 7
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>unknownStruct3</span><span class=o>*</span> <span class=n>r10</span> <span class=o>=</span> <span class=n>r3</span><span class=o>-&gt;</span><span class=n>field84_unknownstruct3_p</span><span class=p>;</span> <span class=c1>// line 8
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>unknownStruct1Ptr</span><span class=o>-&gt;</span><span class=n>field3a_uint16</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// lines 9,11
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>sint16</span> <span class=n>r4</span> <span class=o>=</span> <span class=n>unknownStruct1Ptr</span><span class=o>-&gt;</span><span class=n>field5a_sint16</span><span class=p>;</span> <span class=c1>// line 12
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>unknownStruct4</span><span class=o>*</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>unknownStruct1Ptr</span> <span class=o>+</span> <span class=p>(</span><span class=n>r4</span> <span class=o>*</span> <span class=mi>2</span><span class=p>);</span> <span class=c1>// line 14
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint16</span> <span class=n>r5</span> <span class=o>=</span> <span class=n>r3</span><span class=o>-&gt;</span><span class=n>field5c_uint16</span><span class=p>;</span> <span class=c1>// line 15
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>unknownStruct2</span><span class=o>*</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>unknownStruct1Ptr</span> <span class=o>+</span> <span class=p>(</span><span class=n>r4</span> <span class=o>*</span> <span class=mi>4</span><span class=p>);</span>  <span class=c1>// line 16 - Probably unknownStruct5 == unknownStruct2, since we access the same memory location as in line 7
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>unknownStruct3</span><span class=o>*</span> <span class=n>r0</span> <span class=o>=</span> <span class=n>r3</span><span class=o>-&gt;</span><span class=n>field84_unknownstruct3_p</span><span class=p>;</span> <span class=c1>// line 17 - strong similarity to line 8
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r0</span><span class=o>-&gt;</span><span class=n>field0C_uint16</span><span class=p>;</span> <span class=c1>// line 18
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span><span class=o>*</span> <span class=n>r6</span> <span class=o>=</span> <span class=n>r0</span><span class=o>-&gt;</span><span class=n>field40_p</span><span class=p>;</span> <span class=c1>// line 19  - this is most likely a pointer due to the subsequent address calculations
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint32</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r6</span> <span class=o>+</span> <span class=n>r3</span> <span class=o>+</span> <span class=p>(</span><span class=n>r5</span> <span class=o>*</span> <span class=mi>2</span><span class=p>);</span> <span class=c1>// lines 20, 21
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>uint32</span> <span class=n>r4</span> <span class=o>=</span> <span class=n>r3</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>|</span> <span class=p>(</span><span class=n>r3</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>);</span> <span class=c1>// lines 22, 23, 24 - we effectively obtain a 16-bit value by ORing two 8-bit values, where one was shifted 8 positions to the left
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>uint32</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>r0</span><span class=o>-&gt;</span><span class=n>field12_uint16</span> <span class=o>&amp;</span> <span class=n>r4</span><span class=p>;</span> <span class=c1>// lines 25, 26
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>r1</span> <span class=o>=</span> <span class=n>r6</span> <span class=o>+</span> <span class=n>r3</span><span class=p>;</span> <span class=c1>// line 27 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=nf>perform_magic</span><span class=p>(</span><span class=n>r0</span><span class=p>,</span> <span class=n>r1</span><span class=p>,</span> <span class=o>&amp;</span><span class=p>(</span><span class=n>unknownStruct1Ptr</span><span class=o>-&gt;</span><span class=n>field20_uint32</span><span class=p>));</span> <span class=c1>// lines 13, 28
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>uint32</span> <span class=n>r0</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field34_uint16</span> <span class=o>+</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field28_uint32</span><span class=p>;</span> <span class=c1>// lines 30,31, 32
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>uint32</span> <span class=n>r2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// line 35
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r10</span><span class=o>-&gt;</span><span class=n>field02_c</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// line 34
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>r2</span> <span class=o>=</span> <span class=n>arg1</span><span class=o>-&gt;</span><span class=n>field20_uint32</span><span class=p>;</span> <span class=c1>// line 38
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>uint16</span> <span class=n>r3</span> <span class=o>=</span> <span class=n>unknownStruct1Ptr</span><span class=o>-&gt;</span><span class=n>field36_uint16</span><span class=p>;</span> <span class=c1>// line 40
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>indicator</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// lines 41,42
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>r0</span> <span class=o>=</span> <span class=n>r0</span> <span class=o>+</span> <span class=n>r2</span><span class=p>;</span> <span class=c1>// line 43
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>r3</span> <span class=o>=</span> <span class=n>r3</span> <span class=o>+</span> <span class=n>r2</span><span class=p>;</span> <span class=c1>// line 44
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>dest</span> <span class=o>=</span> <span class=n>r3</span><span class=p>;</span> <span class=c1>// line 46
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=n>r0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2017-12-07</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/ data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11" data-via=evisneffos data-hashtags="ARM,Practical Reverse Engineering"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/ data-hashtag=ARM><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/ data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/ data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/ data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://soffensive.github.io/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/ data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/practical-reverse-engineering/2017-12-06-practical-reverse-engineering-exercise-solutions-page-79-exercise-10/ class=prev rel=prev title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 10"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 10</a>
<a href=/posts/ctf/2018-01-23-pwnable-kr-crypto1-challenge/ class=next rel=next title="pwnable.kr: crypto1 challenge">pwnable.kr: crypto1 challenge<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.146.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>