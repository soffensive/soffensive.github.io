<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6 - soffensive blog</title><meta name="Description" content=""><meta property="og:title" content="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6" />
<meta property="og:description" content="Exercise 6 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called mystery6:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  01: mystery6 02: 2D E9 18 48 PUSH.W {R3,R4,R11,LR} 03: 0D F2 08 0B ADDW R11, SP, #8 04: 04 68 LDR R4, [R0] 05: 00 22 MOVS R2, #0 06: 00 2C CMP R4, #0 07: 06 DD BLE loc_103B3B6 08: loc_103B3A8 09: 50 F8 04 3F LDR." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-04T03:17:00-08:00" />
<meta property="article:modified_time" content="2017-12-04T03:17:00-08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6"/>
<meta name="twitter:description" content="Exercise 6 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called mystery6:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  01: mystery6 02: 2D E9 18 48 PUSH.W {R3,R4,R11,LR} 03: 0D F2 08 0B ADDW R11, SP, #8 04: 04 68 LDR R4, [R0] 05: 00 22 MOVS R2, #0 06: 00 2C CMP R4, #0 07: 06 DD BLE loc_103B3B6 08: loc_103B3A8 09: 50 F8 04 3F LDR."/>
<meta name="application-name" content="soffensive blog">
<meta name="apple-mobile-web-app-title" content="soffensive blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/" /><link rel="prev" href="http://localhost:1313/posts/2017-12-03-practical-reverse-engineering-exercise-solutions-page-79-exercise-5/" /><link rel="next" href="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-7/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6\/"
        },"genre": "posts","keywords": "ARM, Practical Reverse Engineering","wordcount":  1145 ,
        "url": "http:\/\/localhost:1313\/posts\/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6\/","datePublished": "2017-12-04T03:17:00-08:00","dateModified": "2017-12-04T03:17:00-08:00","publisher": {
            "@type": "Organization",
            "name": "soffensive"},"author": {
                "@type": "Person",
                "name": "soffensive"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="soffensive blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>soffensive</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/soffensive" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><a class="menu-item" href="https://twitter.com/evisneffos" title="Twitter" rel="noopener noreffer" target="_blank"><i class='fab fa-twitter fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="soffensive blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>soffensive</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/soffensive" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a class="menu-item" href="https://twitter.com/evisneffos" title="Twitter" rel="noopener noreffer" target="_blank"><i class='fab fa-twitter fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>soffensive</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2017-12-04">2017-12-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1145 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><div class="content" id="content"><p>Exercise 6 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery6</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-nasm" data-lang="nasm"><span class="err">01:</span>             <span class="nf">mystery6</span>
<span class="err">02:</span> <span class="err">2</span><span class="nf">D</span> <span class="nv">E9</span> <span class="mi">18</span> <span class="mi">48</span>   <span class="nv">PUSH.W</span>   <span class="err">{</span><span class="nv">R3</span><span class="p">,</span><span class="nv">R4</span><span class="p">,</span><span class="nv">R11</span><span class="p">,</span><span class="nv">LR</span><span class="err">}</span>
<span class="err">03:</span> <span class="err">0</span><span class="nf">D</span> <span class="nv">F2</span> <span class="mi">08</span> <span class="mb">0B</span>   <span class="nv">ADDW</span>     <span class="nv">R11</span><span class="p">,</span> <span class="nb">SP</span><span class="p">,</span> <span class="err">#</span><span class="mi">8</span>
<span class="err">04:</span> <span class="err">04</span> <span class="err">68</span>         <span class="nf">LDR</span>      <span class="nv">R4</span><span class="p">,</span> <span class="p">[</span><span class="nv">R0</span><span class="p">]</span>
<span class="err">05:</span> <span class="err">00</span> <span class="err">22</span>         <span class="nf">MOVS</span>     <span class="nv">R2</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
<span class="err">06:</span> <span class="err">00</span> <span class="err">2</span><span class="nf">C</span>         <span class="nv">CMP</span>      <span class="nv">R4</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
<span class="err">07:</span> <span class="err">06</span> <span class="kd">DD</span>         <span class="nb">BL</span><span class="nv">E</span>      <span class="nv">loc_103B3B6</span>

<span class="err">08:</span>      <span class="nf">loc_103B3A8</span>
<span class="err">09:</span> <span class="err">50</span> <span class="nf">F8</span> <span class="mi">04</span> <span class="mi">3</span><span class="nv">F</span>   <span class="nv">LDR.W</span>    <span class="nv">R3</span><span class="p">,</span> <span class="p">[</span><span class="nv">R0</span><span class="p">,</span><span class="err">#</span><span class="mi">4</span><span class="p">]</span><span class="err">!</span>
<span class="err">10:</span> <span class="err">8</span><span class="nf">B</span> <span class="mi">42</span>         <span class="nv">CMP</span>      <span class="nv">R3</span><span class="p">,</span> <span class="nv">R1</span>
<span class="err">11:</span> <span class="err">06</span> <span class="nf">D0</span>         <span class="nv">BEQ</span>      <span class="nv">loc_103B3BE</span>
<span class="err">12:</span> <span class="err">01</span> <span class="err">32</span>         <span class="nf">ADDS</span>     <span class="nv">R2</span><span class="p">,</span> <span class="err">#</span><span class="mi">1</span>
<span class="err">13:</span> <span class="nf">A2</span> <span class="mi">42</span>         <span class="nv">CMP</span>      <span class="nv">R2</span><span class="p">,</span> <span class="nv">R4</span>
<span class="err">14:</span> <span class="nf">F8</span> <span class="nv">DB</span>         <span class="nb">BL</span><span class="nv">T</span>      <span class="nv">loc_103B3A8</span>

<span class="err">15:</span>      <span class="nf">loc_103B3B6</span>
<span class="err">16:</span> <span class="err">00</span> <span class="err">20</span>         <span class="nf">MOVS</span>     <span class="nv">R0</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
<span class="err">17:</span> <span class="err">00</span> <span class="err">21</span>         <span class="nf">MOVS</span>     <span class="nv">R1</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>

<span class="err">18:</span>      <span class="nf">locret_103B3BA</span>
<span class="err">19:</span> <span class="nf">BD</span> <span class="nv">E8</span> <span class="mi">18</span> <span class="mi">88</span>   <span class="nv">POP.W</span>    <span class="err">{</span><span class="nv">R3</span><span class="p">,</span><span class="nv">R4</span><span class="p">,</span><span class="nv">R11</span><span class="p">,</span><span class="nv">PC</span><span class="err">}</span>

<span class="err">20:</span>      <span class="nf">loc_103B3BE</span>
<span class="err">21:</span> <span class="nf">B2</span> <span class="nv">F1</span> <span class="mi">20</span> <span class="mi">03</span>   <span class="nv">SUBS.W</span>   <span class="nv">R3</span><span class="p">,</span> <span class="nv">R2</span><span class="p">,</span> <span class="err">#</span><span class="mh">0X20</span>
<span class="err">22:</span> <span class="err">01</span> <span class="err">21</span>         <span class="nf">MOVS</span>     <span class="nv">R1</span><span class="p">,</span> <span class="err">#</span><span class="mi">1</span>
<span class="err">23:</span> <span class="err">99</span> <span class="err">40</span>         <span class="nf">LSLS</span>     <span class="nv">R1</span><span class="p">,</span> <span class="nv">R3</span>
<span class="err">24:</span> <span class="err">01</span> <span class="err">23</span>         <span class="nf">MOVS</span>     <span class="nv">R3</span><span class="p">,</span> <span class="err">#</span><span class="mi">1</span>
<span class="err">25:</span> <span class="err">13</span> <span class="nf">FA</span> <span class="mi">02</span> <span class="nv">F0</span>   <span class="nv">LSLS.W</span>   <span class="nv">R0</span><span class="p">,</span> <span class="nv">R3</span><span class="p">,</span> <span class="nv">R2</span>
<span class="err">26:</span> <span class="nf">F5</span> <span class="nv">E7</span>         <span class="nv">B</span>        <span class="nv">locret_103B3BA</span>
<span class="err">27:</span>             <span class="c1">; End of function mystery6</span>
</code></pre></td></tr></table>
</div>
</div><p>Due to the presence of 16 bit instructions, instructions having the <code>.W</code> suffix and function prologue and epilogue with <code>PUSH</code> and <code>POP</code> respectively, we are dealing with code in Thumb state.</p>
<p>The function apparently takes two arguments in <code>R0</code> and <code>R1</code>, where <code>R0</code> is a pointer to an unknown structure (line 4, line 9) and R1 is a value which is compared to elements of the unknown structure (line 10).  For the return values, it seems both <code>R0</code> and <code>R1</code> contain in this case return values, as both are set prior to exiting the function. For this purpose, we consult the official ARM documentation for the Procedure Call Standard <a href="http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf">http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf</a>.</p>
<p>The relevant section for us is the following:</p>
<blockquote>
<p>A double-word sized Fundamental Data Type (e.g., long long, double and 64-bit containerized vectors) is returned in r0 and r1.</p>
</blockquote>
<p>Thus, the function seems to return a 64 bit value. Our preliminary function prototype is as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="kt">long</span> <span class="kt">long</span> <span class="nf">mystery6</span> <span class="p">(</span><span class="n">unknownStruct</span><span class="o">*</span> <span class="n">arg1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>Lines 1-7 set register <code>R2</code> to zero and examine the value stored at offset <code>0x0</code> of the unknown structure. When it is less or equal to zero, the function returns 0. Otherwise, the second block beginning with line 9 is executed.</p>
<p>There, the value stored af <code>R0+0x4</code> of the unknown structure is loaded and the value of <code>R0</code> increased by <code>0x4</code> afterwards (pre-indexed address mode). This value is compared to the second argument arg2.</p>
<p>In case of inequality, the register value of <code>R2</code> is incremented by 1. Furthermore, <code>R2</code> is compared to the value stored at offset 0x0 of the unknown structure. If it greater than or equal to this value, the function returns 0. If it is less than the value at offset 0x0, the control flow begins again at line 8.</p>
<p>In case of equality, the control flow continues at line 20.</p>
<p>Consequently, the program executes a loop and uses register <code>R2</code> as a counter variable, while the value of the unknown structure at offset <code>0x0</code> serves as a limit parameter. At offset <code>0x4</code> of the unknown structure, there seems to be a sequence of values that each require 4 bytes of storage. We conclude that it probably is an array of type int. The preliminary structure is as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="nl">unknownStruct</span><span class="p">:</span>
<span class="n">field00_i</span><span class="p">;</span> <span class="c1">// limit or size parameter
</span><span class="c1"></span><span class="n">field00_array_i</span><span class="p">;</span> <span class="c1">// array of integers
</span></code></pre></td></tr></table>
</div>
</div><p>With this knowledge in mind, it is highly likely that the element
field00_i stores the number of elements in the array. Thus, we give the
variables more descriptive names:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="nl">unknownStruct</span><span class="p">:</span>
<span class="n">arraySize_i</span><span class="p">;</span> <span class="c1">// number of integers in the variable arrayInts_p
</span><span class="c1"></span><span class="n">arrayInts_p</span><span class="p">;</span> <span class="c1">// array of integers 
</span></code></pre></td></tr></table>
</div>
</div><p>Moreover, the second argument arg2 is compared to the array values and if it cannot be matched to any of the array values, the function returns 0. Thus, the function seems to search after the second argument in the array.</p>
<p>Beginning with line 20, we know that the counter variable <code>R2</code> contains the array index where the second argument can be found. In line 21, the counter variable <code>R2</code> is reduced by 0x20 (decimal 32) and stored in R3. Afterwards, a left shift of the value 0x1 by the value stored in <code>R2</code> is performed and stored in <code>R1</code>. In mathematical terms, we have: <code>R1 = 0x1 &lt;&lt; (R2-0x20)</code>.</p>
<p>Afterwards, a left shift of the value <code>0x1</code> by the counter variable <code>R2</code> is performed and stored in <code>R0</code>.</p>
<p>Lastly, the function epilogue is executed and the values from <code>R3, R4 and R11</code> are restored.</p>
<p>At first glance, the left shifting operations might confuse the uninitiated eye. So what is actually happening here? It might help to recall that the function returns a 64-bit value and the lower 32 bits are stored in <code>R0</code> and the upper 32 bits are stored in <code>R1</code>.</p>
<p>Ratherthan outlining the theoretical possibilities, it may make more sense to take some example values for the counter variable.  Let&rsquo;s consider three different cases:</p>
<ol>
<li>0 &lt;= R2 &lt;= 31</li>
<li>32 &lt;= R2 &lt;= 63</li>
<li>64 &lt;= R2 </li>
</ol>
<p>In the first case, the first shift operation will simply store 0 in <code>R1</code>, as the substraction of 32 from a value in <code>[0;31]</code> will result in a shift operation that moves <code>0x1</code> beyond what can be represented with a 32 bit value. <code>R0</code>, however, will contain a single &ldquo;1&rdquo; bit exactly at the position defined by R2.</p>
<p>In the second case, the first operation will store a single &ldquo;1&rdquo; bit exactly at the position defined by (<code>R2-32</code>), whereas <code>R0</code> only contains zeroes.</p>
<p>In the third case, both <code>R0</code> and <code>R1</code> will only contain zeroes as both shift operations try to shift the least significant bit 0x1 to beyond what can be represented with a 32 bit value.</p>
<p>In a nutshell, the result value <code>R0:R1</code> is a bitmap or bitfield, which contains a single &ldquo;1&rdquo; bit at the position indicates by the counter variable <code>R2</code>, which in turn indicates where in the array of the first argument the second argument can be found.</p>
<p>There is, however, an important caveat: When the second argument is located after the 64th element of the input array, the function will return 0.</p>
<p>Lastly, we provide a decompiled function <code>mystery6</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="k">struct</span> <span class="p">{</span>
 <span class="kt">int</span> <span class="n">arraySize_i</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">arrayInts</span><span class="p">[];</span>
<span class="p">}</span> <span class="n">unknownStruct</span><span class="p">;</span>

<span class="kt">long</span> <span class="kt">long</span> <span class="nf">getBitmapLocationOfValue</span> <span class="p">(</span><span class="n">unknownStruct</span><span class="o">*</span> <span class="n">arg1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">searchValue</span><span class="p">)</span> <span class="p">{</span>
 <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">arg1</span><span class="o">-&gt;</span><span class="n">arraySize_i</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>
 
 <span class="kt">int</span> <span class="n">arrayIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">while</span><span class="p">(</span><span class="n">arg1</span><span class="o">-&gt;</span><span class="n">arrayInts</span><span class="p">[</span><span class="n">arrayIndex</span><span class="p">]</span> <span class="o">!=</span> <span class="n">searchValue</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">arrayIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">arrayIndex</span> <span class="o">&gt;=</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
 
 <span class="kt">long</span> <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="n">arrayIndex</span><span class="p">;</span>
 <span class="k">return</span> <span class="n">result</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2017-12-04</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/" data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6" data-via="evisneffos" data-hashtags="ARM,Practical Reverse Engineering"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/" data-hashtag="ARM"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="http://localhost:1313/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/" data-title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6" data-web><i class="fab fa-whatsapp fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/arm/">ARM</a>,&nbsp;<a href="/tags/practical-reverse-engineering/">Practical Reverse Engineering</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2017-12-03-practical-reverse-engineering-exercise-solutions-page-79-exercise-5/" class="prev" rel="prev" title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 5"><i class="fas fa-angle-left fa-fw"></i>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 5</a>
            <a href="/posts/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-7/" class="next" rel="next" title="Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 7">Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 7<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.83.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2017 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":1000},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
