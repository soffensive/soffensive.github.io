<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.140.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>soffensive blog</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://soffensive.github.io/">
<meta property="og:site_name" content="soffensive blog"><meta property="og:title" content="soffensive blog"><meta property="og:description" content="This is my cool site"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="soffensive blog"><meta name=twitter:description content="This is my cool site"><meta name=twitter:site content="@evisneffos"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://soffensive.github.io/><link rel=alternate href=/index.xml type=application/rss+xml title="soffensive blog"><link rel=feed href=/index.xml type=application/rss+xml title="soffensive blog"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/soffensive.github.io\/","inLanguage":"en","description":"This is my cool site","name":"soffensive blog"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="soffensive blog">soffensive blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/soffensive title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><a class=menu-item href=https://twitter.com/evisneffos title=Twitter rel="noopener noreffer" target=_blank><i class='fab fa-twitter fa-fw'></i> </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="soffensive blog">soffensive blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/soffensive title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a class=menu-item href=https://twitter.com/evisneffos title=Twitter rel="noopener noreffer" target=_blank><i class='fab fa-twitter fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page home" data-home=posts><div class=home-profile><h1 class=home-title>soffensive blog</h1><div class=home-subtitle><div id=id-1 class=typeit></div></div><div class=links><a href=https://github.com/soffensive title=GitHub target=_blank rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=https://twitter.com/evisneffos title=Twitter target=_blank rel="noopener noreffer me"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 11</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-07>2017-12-07</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 11 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery11</code> - the last exercise of the ARM chapter:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span> <span class=err>010185</span><span class=nf>B0</span>             <span class=nv>mystery11</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>010185</span><span class=nf>B0</span> <span class=mi>2</span><span class=nv>D</span> <span class=nv>E9</span> <span class=nv>F8</span> <span class=mi>4</span><span class=nv>F</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R3</span><span class=err>–</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>010185</span><span class=nf>B4</span> <span class=mi>0</span><span class=nv>D</span> <span class=nv>F2</span> <span class=mi>20</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x20</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>010185</span><span class=nf>B8</span> <span class=nv>B0</span> <span class=nv>F9</span> <span class=mi>5</span><span class=nv>A</span> <span class=mi>30</span>   <span class=nv>LDRSH.W</span>  <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x5A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>010185</span><span class=nf>BC</span> <span class=mi>07</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R7</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>010185</span><span class=nf>BE</span> <span class=mi>90</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R8</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>010185</span><span class=nf>C0</span> <span class=mi>00</span> <span class=nv>EB</span> <span class=mi>83</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span><span class=nv>LSL#2</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>010185</span><span class=nf>C4</span> <span class=nv>D3</span> <span class=nv>F8</span> <span class=mi>84</span> <span class=nv>A0</span>   <span class=nv>LDR.W</span>    <span class=nv>R10</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mh>0x84</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>010185</span><span class=nf>C8</span> <span class=mi>7</span><span class=nv>B</span> <span class=mi>8</span><span class=nv>F</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x3A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>010185</span><span class=nf>CA</span> <span class=mi>89</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R9</span><span class=p>,</span> <span class=nv>R1</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>010185</span><span class=nf>CC</span> <span class=nv>CB</span> <span class=nv>B9</span>         <span class=nv>CBNZ</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>loc_1018602</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>010185</span><span class=nf>CE</span> <span class=nv>B0</span> <span class=nv>F9</span> <span class=mi>5</span><span class=nv>A</span> <span class=mi>40</span>   <span class=nv>LDRSH.W</span>  <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x5A</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=err>010185</span><span class=nf>D2</span> <span class=mi>17</span> <span class=nv>F1</span> <span class=mi>20</span> <span class=mi>02</span>   <span class=nv>ADDS.W</span>   <span class=nv>R2</span><span class=p>,</span> <span class=nv>R7</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x20</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=err>010185</span><span class=nf>D6</span> <span class=mi>00</span> <span class=nv>EB</span> <span class=mi>44</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R4</span><span class=p>,</span><span class=nv>LSL#1</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>010185</span><span class=nf>DA</span> <span class=nv>B3</span> <span class=nv>F8</span> <span class=mi>5</span><span class=nv>C</span> <span class=mi>50</span>   <span class=nv>LDRH.W</span>   <span class=nv>R5</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mh>0x5C</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>010185</span><span class=nf>DE</span> <span class=mi>00</span> <span class=nv>EB</span> <span class=mi>84</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R4</span><span class=p>,</span><span class=nv>LSL#2</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>010185</span><span class=nf>E2</span> <span class=nv>D3</span> <span class=nv>F8</span> <span class=mi>84</span> <span class=mi>00</span>   <span class=nv>LDR.W</span>    <span class=nv>R0</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mh>0x84</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>18:</span> <span class=err>010185</span><span class=nf>E6</span> <span class=mi>83</span> <span class=mi>89</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0xC</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=err>010185</span><span class=nf>E8</span> <span class=mi>06</span> <span class=mi>6</span><span class=nv>C</span>         <span class=nv>LDR</span>      <span class=nv>R6</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>20:</span> <span class=err>010185</span><span class=nf>EA</span> <span class=mi>03</span> <span class=nv>EB</span> <span class=mi>45</span> <span class=mi>03</span>   <span class=nv>ADD.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R5</span><span class=p>,</span><span class=nv>LSL#1</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=err>010185</span><span class=nf>EE</span> <span class=mi>9</span><span class=nv>B</span> <span class=mi>19</span>         <span class=nv>ADDS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R6</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>010185</span><span class=nf>F0</span> <span class=mi>1</span><span class=nv>C</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>010185</span><span class=nf>F2</span> <span class=mi>5</span><span class=nv>B</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=err>#</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=err>010185</span><span class=nf>F4</span> <span class=mi>43</span> <span class=nv>EA</span> <span class=mi>04</span> <span class=mi>24</span>   <span class=nv>ORR.W</span>    <span class=nv>R4</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R4</span><span class=p>,</span><span class=nv>LSL#8</span>
</span></span><span class=line><span class=cl><span class=err>25:</span> <span class=err>010185</span><span class=nf>F8</span> <span class=mi>43</span> <span class=mi>8</span><span class=nv>A</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x12</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>26:</span> <span class=err>010185</span><span class=nf>FA</span> <span class=mi>23</span> <span class=mi>40</span>         <span class=nv>ANDS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>27:</span> <span class=err>010185</span><span class=nf>FC</span> <span class=mi>99</span> <span class=mi>19</span>         <span class=nv>ADDS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R6</span>
</span></span><span class=line><span class=cl><span class=err>28:</span> <span class=err>010185</span><span class=nf>FE</span> <span class=nv>FD</span> <span class=nv>F7</span> <span class=mi>8</span><span class=nv>D</span> <span class=nv>FF</span>   <span class=nb>BL</span>       <span class=nv>sub_101651C</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>29:</span> <span class=err>01018602</span>      <span class=nf>loc_1018602</span>
</span></span><span class=line><span class=cl><span class=err>30:</span> <span class=err>01018602</span> <span class=nf>BA</span> <span class=mi>8</span><span class=nv>E</span>         <span class=nv>LDRH</span>     <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x34</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>31:</span> <span class=err>01018604</span> <span class=nf>BB</span> <span class=mi>6</span><span class=nv>A</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x28</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>32:</span> <span class=err>01018606</span> <span class=nf>D0</span> <span class=mi>18</span>         <span class=nv>ADDS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R2</span><span class=p>,</span> <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>33:</span> <span class=err>01018608</span> <span class=err>9</span><span class=nf>A</span> <span class=nv>F8</span> <span class=mi>02</span> <span class=mi>30</span>   <span class=nv>LDRB.W</span>   <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R10</span><span class=p>,</span><span class=err>#</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>34:</span> <span class=err>0101860</span><span class=nf>C</span> <span class=mb>0B</span> <span class=nv>B1</span>         <span class=nv>CBZ</span>      <span class=nv>R3</span><span class=p>,</span> <span class=nv>loc_1018612</span>
</span></span><span class=line><span class=cl><span class=err>35:</span> <span class=err>0101860</span><span class=nf>E</span> <span class=mi>00</span> <span class=mi>22</span>         <span class=nv>MOVS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>36:</span> <span class=err>01018610</span> <span class=err>00</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>loc_1018614</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>37:</span> <span class=err>01018612</span>      <span class=nf>loc_1018612</span>
</span></span><span class=line><span class=cl><span class=err>38:</span> <span class=err>01018612</span> <span class=err>3</span><span class=nf>A</span> <span class=mi>6</span><span class=nv>A</span>         <span class=nv>LDR</span>      <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x20</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>39:</span> <span class=err>01018614</span>      <span class=nf>loc_1018614</span>
</span></span><span class=line><span class=cl><span class=err>40:</span> <span class=err>01018614</span> <span class=nf>FB</span> <span class=mi>8</span><span class=nv>E</span>         <span class=nv>LDRH</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R7</span><span class=p>,</span><span class=err>#</span><span class=mh>0x36</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>41:</span> <span class=err>01018616</span> <span class=nf>B8</span> <span class=nv>F1</span> <span class=mi>00</span> <span class=mi>0</span><span class=nv>F</span>   <span class=nv>CMP.W</span>    <span class=nv>R8</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>42:</span> <span class=err>0101861</span><span class=nf>A</span> <span class=mi>01</span> <span class=nv>D0</span>         <span class=nv>BEQ</span>      <span class=nv>loc_1018620</span>
</span></span><span class=line><span class=cl><span class=err>43:</span> <span class=err>0101861</span><span class=nf>C</span> <span class=mi>80</span> <span class=mi>18</span>         <span class=nv>ADDS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R0</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>44:</span> <span class=err>0101861</span><span class=nf>E</span> <span class=mi>9</span><span class=nv>B</span> <span class=mi>1</span><span class=nv>A</span>         <span class=nv>SUBS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>45:</span> <span class=err>01018620</span>      <span class=nf>loc_1018620</span>
</span></span><span class=line><span class=cl><span class=err>46:</span> <span class=err>01018620</span> <span class=nf>C9</span> <span class=nv>F8</span> <span class=mi>00</span> <span class=mi>30</span>   <span class=nv>STR.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R9</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>47:</span> <span class=err>01018624</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=nv>F8</span> <span class=mi>8</span><span class=nv>F</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R3</span><span class=err>–</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>48:</span> <span class=err>01018624</span>             <span class=c1>; End of function mystery11</span>
</span></span></code></pre></td></tr></table></div></div><p>According to the exercise description, the called subroutine <code>sub_101651C</code> in line 28 takes three arguments and does not return anything. Thus, we know the registers <code>R0</code>, <code>R1</code> and <code>R2</code> are prepared and passed to the function.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-07-practical-reverse-engineering-exercise-solutions-page-79-exercise-11/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-06-practical-reverse-engineering-exercise-solutions-page-79-exercise-10/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 10</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-06>2017-12-06</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 10 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery10</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery10</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>2</span><span class=nf>D</span> <span class=nv>E9</span> <span class=mi>70</span> <span class=mi>48</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R4</span><span class=err>–</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>0</span><span class=nf>D</span> <span class=nv>F2</span> <span class=mi>0</span><span class=nv>C</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mh>0xC</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>37</span> <span class=nf>F0</span> <span class=nv>CC</span> <span class=nv>F9</span>   <span class=nb>BL</span>       <span class=nv>__security_push_cookie</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>84</span> <span class=nf>B0</span>         <span class=nv>SUB</span>      <span class=nb>SP</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>0</span><span class=nf>D</span> <span class=mi>46</span>         <span class=nv>MOV</span>      <span class=nv>R5</span><span class=p>,</span> <span class=nv>R1</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>00</span> <span class=err>24</span>         <span class=nf>MOVS</span>     <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>10</span> <span class=err>2</span><span class=nf>D</span>         <span class=nv>CMP</span>      <span class=nv>R5</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>16</span> <span class=err>46</span>         <span class=nf>MOV</span>      <span class=nv>R6</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>0</span><span class=nf>C</span> <span class=nv>D3</span>         <span class=nv>BCC</span>      <span class=nv>loc_1010786</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>1</span><span class=nf>A</span> <span class=mi>4</span><span class=nv>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>=</span><span class=nv>__imp_GetSystemTime</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>68</span> <span class=err>46</span>         <span class=nf>MOV</span>      <span class=nv>R0</span><span class=p>,</span> <span class=nb>SP</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=err>1</span><span class=nf>B</span> <span class=mi>68</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=err>98</span> <span class=err>47</span>         <span class=nf>BLX</span>      <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>00</span> <span class=err>9</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nb>SP</span><span class=p>,</span><span class=err>#</span><span class=mh>0x1C</span><span class=o>+</span><span class=nv>var_1C</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>10</span> <span class=err>24</span>         <span class=nf>MOVS</span>     <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>33</span> <span class=err>60</span>         <span class=nf>STR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>18:</span> <span class=err>01</span> <span class=err>9</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nb>SP</span><span class=p>,</span><span class=err>#</span><span class=mh>0x1C</span><span class=o>+</span><span class=nv>var_18</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=err>73</span> <span class=err>60</span>         <span class=nf>STR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>,</span><span class=err>#</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>20:</span> <span class=err>02</span> <span class=err>9</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nb>SP</span><span class=p>,</span><span class=err>#</span><span class=mh>0x1C</span><span class=o>+</span><span class=nv>var_14</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=nf>B3</span> <span class=mi>60</span>         <span class=nv>STR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>,</span><span class=err>#</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>03</span> <span class=err>9</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nb>SP</span><span class=p>,</span><span class=err>#</span><span class=mh>0x1C</span><span class=o>+</span><span class=nv>var_10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=nf>F3</span> <span class=mi>60</span>         <span class=nv>STR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>,</span><span class=err>#</span><span class=mh>0xC</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>24:</span>      <span class=nf>loc_1010786</span>
</span></span><span class=line><span class=cl><span class=err>25:</span> <span class=err>2</span><span class=nf>B</span> <span class=mb>1B</span>         <span class=nv>SUBS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R5</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>26:</span> <span class=err>04</span> <span class=err>2</span><span class=nf>B</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=err>27:</span> <span class=err>04</span> <span class=nf>D3</span>         <span class=nv>BCC</span>      <span class=nv>loc_1010796</span>
</span></span><span class=line><span class=cl><span class=err>28:</span> <span class=err>11</span> <span class=err>4</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>=</span><span class=nv>__imp_GetCurrentProcessId</span>
</span></span><span class=line><span class=cl><span class=err>29:</span> <span class=err>1</span><span class=nf>B</span> <span class=mi>68</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>30:</span> <span class=err>98</span> <span class=err>47</span>         <span class=nf>BLX</span>      <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>31:</span> <span class=err>30</span> <span class=err>51</span>         <span class=nf>STR</span>      <span class=nv>R0</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>32:</span> <span class=err>04</span> <span class=err>34</span>         <span class=nf>ADDS</span>     <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>33:</span>      <span class=nf>loc_1010796</span>
</span></span><span class=line><span class=cl><span class=err>34:</span> <span class=err>2</span><span class=nf>B</span> <span class=mb>1B</span>         <span class=nv>SUBS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R5</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>35:</span> <span class=err>04</span> <span class=err>2</span><span class=nf>B</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=err>36:</span> <span class=err>04</span> <span class=nf>D3</span>         <span class=nv>BCC</span>      <span class=nv>loc_10107A6</span>
</span></span><span class=line><span class=cl><span class=err>37:</span> <span class=err>0</span><span class=nf>C</span> <span class=mi>4</span><span class=nv>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>=</span><span class=nv>__imp_GetTickCount</span>
</span></span><span class=line><span class=cl><span class=err>38:</span> <span class=err>1</span><span class=nf>B</span> <span class=mi>68</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>39:</span> <span class=err>98</span> <span class=err>47</span>         <span class=nf>BLX</span>      <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>40:</span> <span class=err>30</span> <span class=err>51</span>         <span class=nf>STR</span>      <span class=nv>R0</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>41:</span> <span class=err>04</span> <span class=err>34</span>         <span class=nf>ADDS</span>     <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>42:</span>      <span class=nf>loc_10107A6</span>
</span></span><span class=line><span class=cl><span class=err>43:</span> <span class=err>2</span><span class=nf>B</span> <span class=mb>1B</span>         <span class=nv>SUBS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=nv>R5</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>44:</span> <span class=err>08</span> <span class=err>2</span><span class=nf>B</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=err>45:</span> <span class=err>09</span> <span class=nf>D3</span>         <span class=nv>BCC</span>      <span class=nv>loc_10107C0</span>
</span></span><span class=line><span class=cl><span class=err>46:</span> <span class=err>07</span> <span class=err>4</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>=</span><span class=nv>__imp_QueryPerformanceCounter</span>
</span></span><span class=line><span class=cl><span class=err>47:</span> <span class=err>68</span> <span class=err>46</span>         <span class=nf>MOV</span>      <span class=nv>R0</span><span class=p>,</span> <span class=nb>SP</span>
</span></span><span class=line><span class=cl><span class=err>48:</span> <span class=err>1</span><span class=nf>B</span> <span class=mi>68</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>49:</span> <span class=err>98</span> <span class=err>47</span>         <span class=nf>BLX</span>      <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>50:</span> <span class=err>00</span> <span class=err>9</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nb>SP</span><span class=p>,</span><span class=err>#</span><span class=mh>0x1C</span><span class=o>+</span><span class=nv>var_1C</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>51:</span> <span class=err>32</span> <span class=err>19</span>         <span class=nf>ADDS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=nv>R6</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>52:</span> <span class=err>33</span> <span class=err>51</span>         <span class=nf>STR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>53:</span> <span class=err>01</span> <span class=err>9</span><span class=nf>B</span>         <span class=nv>LDR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nb>SP</span><span class=p>,</span><span class=err>#</span><span class=mh>0x1C</span><span class=o>+</span><span class=nv>var_18</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>54:</span> <span class=err>08</span> <span class=err>34</span>         <span class=nf>ADDS</span>     <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=err>55:</span> <span class=err>53</span> <span class=err>60</span>         <span class=nf>STR</span>      <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R2</span><span class=p>,</span><span class=err>#</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>56:</span>      <span class=nf>loc_10107C0</span>
</span></span><span class=line><span class=cl><span class=err>57:</span> <span class=err>20</span> <span class=err>46</span>         <span class=nf>MOV</span>      <span class=nv>R0</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>58:</span> <span class=err>04</span> <span class=nf>B0</span>         <span class=nv>ADD</span>      <span class=nb>SP</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=err>59:</span> <span class=err>37</span> <span class=nf>F0</span> <span class=nv>A4</span> <span class=nv>F9</span>   <span class=nb>BL</span>              <span class=nv>__security_pop_cookie</span>
</span></span><span class=line><span class=cl><span class=err>60:</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=mi>70</span> <span class=mi>88</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R4</span><span class=err>–</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>61:</span>             <span class=c1>; End of function mystery10</span>
</span></span></code></pre></td></tr></table></div></div><p>Although the function looks complicated at first, we notice it does not contain any kind of loops and only executes sequentially with a couple of conditionals.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-06-practical-reverse-engineering-exercise-solutions-page-79-exercise-10/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-05-practical-reverse-engineering-exercise-solutions-page-79-exercise-9/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 9</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-05>2017-12-05</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 9 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery9</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery9</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>2</span><span class=nf>D</span> <span class=nv>E9</span> <span class=mi>30</span> <span class=mi>48</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R5</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>0</span><span class=nf>D</span> <span class=nv>F2</span> <span class=mi>08</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>09</span> <span class=err>4</span><span class=nf>D</span>         <span class=nv>LDR</span>      <span class=nv>R5</span><span class=p>,</span> <span class=err>=</span><span class=kt>byte</span><span class=nv>Array</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>06</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>loc_100E312</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>06:</span>      <span class=nf>loc_100E304</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>0</span><span class=nf>B</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>5</span><span class=nf>A</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>63</span> <span class=err>5</span><span class=nf>D</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>93</span> <span class=err>42</span>         <span class=nf>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>04</span> <span class=nf>D1</span>         <span class=nv>BNE</span>      <span class=nv>loc_100E318</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>01</span> <span class=err>30</span>         <span class=nf>ADDS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=err>01</span> <span class=err>31</span>         <span class=nf>ADDS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>14:</span>      <span class=nf>loc_100E312</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>04</span> <span class=err>78</span>         <span class=nf>LDRB</span>     <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>C</span>         <span class=nv>CMP</span>      <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=nf>F5</span> <span class=nv>D1</span>         <span class=nv>BNE</span>      <span class=nv>loc_100E304</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>18:</span>      <span class=nf>loc_100E318</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=err>0</span><span class=nf>B</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>20:</span> <span class=err>5</span><span class=nf>A</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=err>03</span> <span class=err>78</span>         <span class=nf>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>5</span><span class=nf>B</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>98</span> <span class=err>1</span><span class=nf>A</span>         <span class=nv>SUBS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=mi>30</span> <span class=mi>88</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R5</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>25:</span>             <span class=c1>; End of function mystery9</span>
</span></span></code></pre></td></tr></table></div></div><p>First of all, <code>mystery9</code> has a striking similarity to the previously decompiled function <code>mystery8</code>. Its disassembly uses Thumb mode, as we can see for instance from the 16 bit instruction width.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-05-practical-reverse-engineering-exercise-solutions-page-79-exercise-9/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-05-practical-reverse-engineering-exercise-solutions-page-79-exercise-8/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 8</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-05>2017-12-05</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 8 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery8</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery8</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>2</span><span class=nf>D</span> <span class=nv>E9</span> <span class=mi>78</span> <span class=mi>48</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R3</span><span class=err>–</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>0</span><span class=nf>D</span> <span class=nv>F2</span> <span class=mi>10</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>0</span><span class=nf>C</span> <span class=mi>4</span><span class=nv>E</span>         <span class=nv>LDR</span>      <span class=nv>R6</span><span class=p>,</span> <span class=err>=</span><span class=kt>byte</span><span class=nv>Array</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>09</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>loc_100E34C</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>06:</span>      <span class=nf>loc_100E338</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>05</span> <span class=err>78</span>         <span class=nf>LDRB</span>     <span class=nv>R5</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>01</span> <span class=err>3</span><span class=nf>A</span>         <span class=nv>SUBS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>4</span><span class=nf>D</span> <span class=nv>B1</span>         <span class=nv>CBZ</span>      <span class=nv>R5</span><span class=p>,</span> <span class=nv>loc_100E352</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>0</span><span class=nf>B</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>9</span><span class=nf>C</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=nf>AB</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R5</span><span class=p>,</span><span class=nv>R6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=nf>A3</span> <span class=mi>42</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=err>04</span> <span class=nf>D1</span>         <span class=nv>BNE</span>      <span class=nv>loc_100E352</span> 
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>01</span> <span class=err>30</span>         <span class=nf>ADDS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>01</span> <span class=err>31</span>         <span class=nf>ADDS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>17:</span>      <span class=nf>loc_100E34C</span>
</span></span><span class=line><span class=cl><span class=err>18:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>A</span>         <span class=nv>CMP</span>      <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=nf>F3</span> <span class=nv>DC</span>         <span class=nv>BGT</span>      <span class=nv>loc_100E338</span>
</span></span><span class=line><span class=cl><span class=err>20:</span> <span class=err>01</span> <span class=err>3</span><span class=nf>A</span>         <span class=nv>SUBS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>21:</span>      <span class=nf>loc_100E352</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>A</span>         <span class=nv>CMP</span>      <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>01</span> <span class=nf>DA</span>         <span class=nv>BGE</span>      <span class=nv>loc_100E35A</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>25:</span> <span class=err>04</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>locret_100E364</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>26:</span>      <span class=nf>loc_100E35A</span>
</span></span><span class=line><span class=cl><span class=err>27:</span> <span class=err>0</span><span class=nf>B</span> <span class=mi>78</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>28:</span> <span class=err>9</span><span class=nf>A</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R2</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>29:</span> <span class=err>03</span> <span class=err>78</span>         <span class=nf>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>30:</span> <span class=err>9</span><span class=nf>B</span> <span class=mi>5</span><span class=nv>D</span>         <span class=nv>LDRB</span>     <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>31:</span> <span class=err>98</span> <span class=err>1</span><span class=nf>A</span>         <span class=nv>SUBS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>32:</span>      <span class=nf>locret_100E364</span>
</span></span><span class=line><span class=cl><span class=err>33:</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=mi>78</span> <span class=mi>88</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R3</span><span class=err>–</span><span class=nv>R6</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>34:</span>             <span class=c1>; End of function mystery8</span>
</span></span></code></pre></td></tr></table></div></div><p>The function was compiled in Thumb mode, as we can see from the presence of 16 bit instructions, <code>PUSH</code> and <code>POP</code> instructions and Thumb-specific instructions, e.g. <code>CBZ</code> and instructions with the <code>.W</code> suffix.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-05-practical-reverse-engineering-exercise-solutions-page-79-exercise-8/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-7/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 7</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-04>2017-12-04</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 7 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery7</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery7</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>02</span> <span class=err>46</span>         <span class=nf>MOV</span>      <span class=nv>R2</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>08</span> <span class=nf>B9</span>         <span class=nv>CBNZ</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>loc_100E1D8</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>       <span class=nv>LR</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>06:</span>      <span class=nf>loc_100E1D8</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>90</span> <span class=nf>F9</span> <span class=mi>00</span> <span class=mi>30</span>   <span class=nv>LDRSB.W</span>  <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>02</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>loc_100E1E4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>09:</span>      <span class=nf>loc_100E1DE</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>01</span> <span class=err>32</span>         <span class=nf>ADDS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>92</span> <span class=nf>F9</span> <span class=mi>00</span> <span class=mi>30</span>   <span class=nv>LDRSB.W</span>  <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>12:</span>      <span class=nf>loc_100E1E4</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>B</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=nf>FA</span> <span class=nv>D1</span>         <span class=nv>BNE</span>      <span class=nv>loc_100E1DE</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>10</span> <span class=err>1</span><span class=nf>A</span>         <span class=nv>SUBS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R2</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>6</span><span class=nf>F</span> <span class=nv>F3</span> <span class=mi>9</span><span class=nv>F</span> <span class=mi>70</span>   <span class=nv>BFC.W</span>    <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x1E</span><span class=p>,</span> <span class=err>#</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>       <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>18:</span>             <span class=c1>; End of function mystery7</span>
</span></span></code></pre></td></tr></table></div></div><p>Again, the function provided is executed in Thumb mode, due to several 16 bit instructions and instructions specific to Thumb mode such as <code>CBNZ</code> and the <code>.W</code> suffix such as in line 7, 11 and 16.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-7/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-04>2017-12-04</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 6 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery6</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery6</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>2</span><span class=nf>D</span> <span class=nv>E9</span> <span class=mi>18</span> <span class=mi>48</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>0</span><span class=nf>D</span> <span class=nv>F2</span> <span class=mi>08</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>04</span> <span class=err>68</span>         <span class=nf>LDR</span>      <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>00</span> <span class=err>22</span>         <span class=nf>MOVS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>C</span>         <span class=nv>CMP</span>      <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>06</span> <span class=kd>DD</span>         <span class=nb>BL</span><span class=nv>E</span>      <span class=nv>loc_103B3B6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>08:</span>      <span class=nf>loc_103B3A8</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>50</span> <span class=nf>F8</span> <span class=mi>04</span> <span class=mi>3</span><span class=nv>F</span>   <span class=nv>LDR.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mi>4</span><span class=p>]</span><span class=err>!</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>8</span><span class=nf>B</span> <span class=mi>42</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=nv>R1</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>06</span> <span class=nf>D0</span>         <span class=nv>BEQ</span>      <span class=nv>loc_103B3BE</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>01</span> <span class=err>32</span>         <span class=nf>ADDS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=nf>A2</span> <span class=mi>42</span>         <span class=nv>CMP</span>      <span class=nv>R2</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=nf>F8</span> <span class=nv>DB</span>         <span class=nb>BL</span><span class=nv>T</span>      <span class=nv>loc_103B3A8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>15:</span>      <span class=nf>loc_103B3B6</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>00</span> <span class=err>21</span>         <span class=nf>MOVS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>18:</span>      <span class=nf>locret_103B3BA</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=mi>18</span> <span class=mi>88</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>20:</span>      <span class=nf>loc_103B3BE</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=nf>B2</span> <span class=nv>F1</span> <span class=mi>20</span> <span class=mi>03</span>   <span class=nv>SUBS.W</span>   <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mh>0X20</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>01</span> <span class=err>21</span>         <span class=nf>MOVS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>99</span> <span class=err>40</span>         <span class=nf>LSLS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=err>01</span> <span class=err>23</span>         <span class=nf>MOVS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>25:</span> <span class=err>13</span> <span class=nf>FA</span> <span class=mi>02</span> <span class=nv>F0</span>   <span class=nv>LSLS.W</span>   <span class=nv>R0</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>26:</span> <span class=nf>F5</span> <span class=nv>E7</span>         <span class=nv>B</span>        <span class=nv>locret_103B3BA</span>
</span></span><span class=line><span class=cl><span class=err>27:</span>             <span class=c1>; End of function mystery6</span>
</span></span></code></pre></td></tr></table></div></div><p>Due to the presence of 16 bit instructions, instructions having the <code>.W</code> suffix and function prologue and epilogue with <code>PUSH</code> and <code>POP</code> respectively, we are dealing with code in Thumb state.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><ul class=pagination><li class=page-item><span class=page-link><a href=/>1</a></span></li><li class="page-item active"><span class=page-link><a href=/page/2/>2</a></span></li><li class=page-item><span class=page-link><a href=/page/3/>3</a></span></li><li class=page-item><span class=page-link><a href=/page/4/>4</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/6/>6</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.140.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},data:{"id-1":"Another blog about software security issues"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>