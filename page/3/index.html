<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.145.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>soffensive blog</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://soffensive.github.io/">
<meta property="og:site_name" content="soffensive blog"><meta property="og:title" content="soffensive blog"><meta property="og:description" content="This is my cool site"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="soffensive blog"><meta name=twitter:description content="This is my cool site"><meta name=twitter:site content="@evisneffos"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://soffensive.github.io/><link rel=alternate href=/index.xml type=application/rss+xml title="soffensive blog"><link rel=feed href=/index.xml type=application/rss+xml title="soffensive blog"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"https:\/\/soffensive.github.io\/","inLanguage":"en","description":"This is my cool site","name":"soffensive blog"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="soffensive blog">soffensive blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/soffensive title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><a class=menu-item href=https://twitter.com/evisneffos title=Twitter rel="noopener noreffer" target=_blank><i class='fab fa-twitter fa-fw'></i> </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="soffensive blog">soffensive blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/soffensive title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a class=menu-item href=https://twitter.com/evisneffos title=Twitter rel="noopener noreffer" target=_blank><i class='fab fa-twitter fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page home" data-home=posts><div class=home-profile><h1 class=home-title>soffensive blog</h1><div class=home-subtitle><div id=id-1 class=typeit></div></div><div class=links><a href=https://github.com/soffensive title=GitHub target=_blank rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=https://twitter.com/evisneffos title=Twitter target=_blank rel="noopener noreffer me"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-7/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 7</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-04>2017-12-04</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 7 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery7</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery7</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>02</span> <span class=err>46</span>         <span class=nf>MOV</span>      <span class=nv>R2</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>08</span> <span class=nf>B9</span>         <span class=nv>CBNZ</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>loc_100E1D8</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>       <span class=nv>LR</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>06:</span>      <span class=nf>loc_100E1D8</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>90</span> <span class=nf>F9</span> <span class=mi>00</span> <span class=mi>30</span>   <span class=nv>LDRSB.W</span>  <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>02</span> <span class=nf>E0</span>         <span class=nv>B</span>        <span class=nv>loc_100E1E4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>09:</span>      <span class=nf>loc_100E1DE</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>01</span> <span class=err>32</span>         <span class=nf>ADDS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>92</span> <span class=nf>F9</span> <span class=mi>00</span> <span class=mi>30</span>   <span class=nv>LDRSB.W</span>  <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>12:</span>      <span class=nf>loc_100E1E4</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>B</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=nf>FA</span> <span class=nv>D1</span>         <span class=nv>BNE</span>      <span class=nv>loc_100E1DE</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>10</span> <span class=err>1</span><span class=nf>A</span>         <span class=nv>SUBS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>R2</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>6</span><span class=nf>F</span> <span class=nv>F3</span> <span class=mi>9</span><span class=nv>F</span> <span class=mi>70</span>   <span class=nv>BFC.W</span>    <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mh>0x1E</span><span class=p>,</span> <span class=err>#</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>       <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>18:</span>             <span class=c1>; End of function mystery7</span>
</span></span></code></pre></td></tr></table></div></div><p>Again, the function provided is executed in Thumb mode, due to several 16 bit instructions and instructions specific to Thumb mode such as <code>CBNZ</code> and the <code>.W</code> suffix such as in line 7, 11 and 16.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-7/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 6</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-04>2017-12-04</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 6 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery6</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery6</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>2</span><span class=nf>D</span> <span class=nv>E9</span> <span class=mi>18</span> <span class=mi>48</span>   <span class=nv>PUSH.W</span>   <span class=err>{</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>LR</span><span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>0</span><span class=nf>D</span> <span class=nv>F2</span> <span class=mi>08</span> <span class=mb>0B</span>   <span class=nv>ADDW</span>     <span class=nv>R11</span><span class=p>,</span> <span class=nb>SP</span><span class=p>,</span> <span class=err>#</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>04</span> <span class=err>68</span>         <span class=nf>LDR</span>      <span class=nv>R4</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>00</span> <span class=err>22</span>         <span class=nf>MOVS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>00</span> <span class=err>2</span><span class=nf>C</span>         <span class=nv>CMP</span>      <span class=nv>R4</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>06</span> <span class=kd>DD</span>         <span class=nb>BL</span><span class=nv>E</span>      <span class=nv>loc_103B3B6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>08:</span>      <span class=nf>loc_103B3A8</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>50</span> <span class=nf>F8</span> <span class=mi>04</span> <span class=mi>3</span><span class=nv>F</span>   <span class=nv>LDR.W</span>    <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mi>4</span><span class=p>]</span><span class=err>!</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>8</span><span class=nf>B</span> <span class=mi>42</span>         <span class=nv>CMP</span>      <span class=nv>R3</span><span class=p>,</span> <span class=nv>R1</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>06</span> <span class=nf>D0</span>         <span class=nv>BEQ</span>      <span class=nv>loc_103B3BE</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>01</span> <span class=err>32</span>         <span class=nf>ADDS</span>     <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>13:</span> <span class=nf>A2</span> <span class=mi>42</span>         <span class=nv>CMP</span>      <span class=nv>R2</span><span class=p>,</span> <span class=nv>R4</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=nf>F8</span> <span class=nv>DB</span>         <span class=nb>BL</span><span class=nv>T</span>      <span class=nv>loc_103B3A8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>15:</span>      <span class=nf>loc_103B3B6</span>
</span></span><span class=line><span class=cl><span class=err>16:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>00</span> <span class=err>21</span>         <span class=nf>MOVS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>18:</span>      <span class=nf>locret_103B3BA</span>
</span></span><span class=line><span class=cl><span class=err>19:</span> <span class=nf>BD</span> <span class=nv>E8</span> <span class=mi>18</span> <span class=mi>88</span>   <span class=nv>POP.W</span>    <span class=err>{</span><span class=nv>R3</span><span class=p>,</span><span class=nv>R4</span><span class=p>,</span><span class=nv>R11</span><span class=p>,</span><span class=nv>PC</span><span class=err>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>20:</span>      <span class=nf>loc_103B3BE</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=nf>B2</span> <span class=nv>F1</span> <span class=mi>20</span> <span class=mi>03</span>   <span class=nv>SUBS.W</span>   <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span><span class=p>,</span> <span class=err>#</span><span class=mh>0X20</span>
</span></span><span class=line><span class=cl><span class=err>22:</span> <span class=err>01</span> <span class=err>21</span>         <span class=nf>MOVS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>99</span> <span class=err>40</span>         <span class=nf>LSLS</span>     <span class=nv>R1</span><span class=p>,</span> <span class=nv>R3</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=err>01</span> <span class=err>23</span>         <span class=nf>MOVS</span>     <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>25:</span> <span class=err>13</span> <span class=nf>FA</span> <span class=mi>02</span> <span class=nv>F0</span>   <span class=nv>LSLS.W</span>   <span class=nv>R0</span><span class=p>,</span> <span class=nv>R3</span><span class=p>,</span> <span class=nv>R2</span>
</span></span><span class=line><span class=cl><span class=err>26:</span> <span class=nf>F5</span> <span class=nv>E7</span>         <span class=nv>B</span>        <span class=nv>locret_103B3BA</span>
</span></span><span class=line><span class=cl><span class=err>27:</span>             <span class=c1>; End of function mystery6</span>
</span></span></code></pre></td></tr></table></div></div><p>Due to the presence of 16 bit instructions, instructions having the <code>.W</code> suffix and function prologue and epilogue with <code>PUSH</code> and <code>POP</code> respectively, we are dealing with code in Thumb state.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-04-practical-reverse-engineering-exercise-solutions-page-79-exercise-6/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-03-practical-reverse-engineering-exercise-solutions-page-79-exercise-5/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 5</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-03>2017-12-03</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 5 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function called <code>mystery5</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>   <span class=nf>mystery5</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>03</span> <span class=err>46</span>    <span class=nf>MOV</span>   <span class=nv>R3</span><span class=p>,</span> <span class=nv>R0</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>06</span> <span class=err>2</span><span class=nf>B</span>    <span class=nv>CMP</span>   <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>0</span><span class=nf>D</span> <span class=nv>D0</span>    <span class=nv>BEQ</span>   <span class=nv>loc_1032596</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>07</span> <span class=err>2</span><span class=nf>B</span>    <span class=nv>CMP</span>   <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>09</span> <span class=nf>D0</span>    <span class=nv>BEQ</span>   <span class=nv>loc_1032592</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>08</span> <span class=err>2</span><span class=nf>B</span>    <span class=nv>CMP</span>   <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=err>08:</span> <span class=err>05</span> <span class=nf>D0</span>    <span class=nv>BEQ</span>   <span class=nv>loc_103258E</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>09</span> <span class=err>2</span><span class=nf>B</span>    <span class=nv>CMP</span>   <span class=nv>R3</span><span class=p>,</span> <span class=err>#</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>01</span> <span class=nf>D0</span>    <span class=nv>BEQ</span>   <span class=nv>loc_103258A</span>
</span></span><span class=line><span class=cl><span class=err>11:</span> <span class=err>09</span> <span class=err>48</span>    <span class=nf>LDR</span>   <span class=nv>R0</span><span class=p>,</span> <span class=err>=</span><span class=nv>aA</span> <span class=c1>; &#34;A&#34;</span>
</span></span><span class=line><span class=cl><span class=err>12:</span> <span class=err>70</span> <span class=err>47</span>    <span class=nf>BX</span>    <span class=nv>LR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>13:</span>   <span class=nf>loc_103258A</span>
</span></span><span class=line><span class=cl><span class=err>14:</span> <span class=err>07</span> <span class=err>48</span>    <span class=nf>LDR</span>   <span class=nv>R0</span><span class=p>,</span> <span class=err>=</span><span class=nv>aB</span> <span class=c1>; &#34;B&#34;</span>
</span></span><span class=line><span class=cl><span class=err>15:</span> <span class=err>70</span> <span class=err>47</span>    <span class=nf>BX</span>    <span class=nv>LR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>16:</span>   <span class=nf>loc_103258E</span>
</span></span><span class=line><span class=cl><span class=err>17:</span> <span class=err>05</span> <span class=err>48</span>    <span class=nf>LDR</span>   <span class=nv>R0</span><span class=p>,</span> <span class=err>=</span><span class=nv>ac</span> <span class=c1>; &#34;C&#34;</span>
</span></span><span class=line><span class=cl><span class=err>18:</span> <span class=err>70</span> <span class=err>47</span>    <span class=nf>BX</span>    <span class=nv>LR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>19:</span>   <span class=nf>loc_1032592</span>
</span></span><span class=line><span class=cl><span class=err>20:</span> <span class=err>03</span> <span class=err>48</span>    <span class=nf>LDR</span>   <span class=nv>R0</span><span class=p>,</span> <span class=err>=</span><span class=nv>aD</span> <span class=c1>; &#34;D&#34;</span>
</span></span><span class=line><span class=cl><span class=err>21:</span> <span class=err>70</span> <span class=err>47</span>    <span class=nf>BX</span>    <span class=nv>LR</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>22:</span>   <span class=nf>loc_1032596</span>
</span></span><span class=line><span class=cl><span class=err>23:</span> <span class=err>01</span> <span class=err>48</span>    <span class=nf>LDR</span>   <span class=nv>R0</span><span class=p>,</span> <span class=err>=</span><span class=nv>aE</span> <span class=c1>; &#34;E&#34;</span>
</span></span><span class=line><span class=cl><span class=err>24:</span> <span class=err>70</span> <span class=err>47</span>    <span class=nf>BX</span>    <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>25:</span>   <span class=c1>; End of function mystery5</span>
</span></span></code></pre></td></tr></table></div></div><p>All instructions have a width of 16 bits, so we are dealing with code in Thumb state.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-03-practical-reverse-engineering-exercise-solutions-page-79-exercise-5/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-02-practical-reverse-engineering-exercise-solutions-page-79-exercise-4/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 4</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-02>2017-12-02</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 4 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function <code>mystery4</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery4</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>08</span> <span class=nf>B9</span>         <span class=nv>CBNZ</span>     <span class=nv>R0</span><span class=p>,</span> <span class=nv>loc_100C3DA</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>       <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>05:</span>             <span class=nf>loc_100C3DA</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>50</span> <span class=nf>F8</span> <span class=mi>08</span> <span class=mi>0</span><span class=nv>C</span>   <span class=nv>LDR.W</span>    <span class=nv>R0</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#â€“</span><span class=mi>8</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>       <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>08:</span>             <span class=c1>; End of function mystery4</span>
</span></span></code></pre></td></tr></table></div></div><p>The disassembly is in Thumb mode, as there are instructions having a width of 16 bits and some instructions specific to this mode (e.g. <code>CBNZ</code> and the <code>.W</code> suffix).</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-02-practical-reverse-engineering-exercise-solutions-page-79-exercise-4/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-02-practical-reverse-engineering-exercise-solutions-page-79-exercise-3/>Practical Reverse Engineering Exercise Solutions: Page 79 / Exercise 3</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-02>2017-12-02</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 3 on page 79 of the book Practical Reverse Engineering specifies the following ARM disassembly of a function <code>mystery3</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery3</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>83</span> <span class=err>68</span>         <span class=nf>LDR</span>             <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>0</span><span class=nf>B</span> <span class=mi>60</span>         <span class=nv>STR</span>             <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=nf>C3</span> <span class=mi>68</span>         <span class=nv>LDR</span>             <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0xC</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>00</span> <span class=err>20</span>         <span class=nf>MOVS</span>            <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>4</span><span class=nf>B</span> <span class=mi>60</span>         <span class=nv>STR</span>             <span class=nv>R3</span><span class=p>,</span> <span class=p>[</span><span class=nv>R1</span><span class=p>,</span><span class=err>#</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>              <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>08:</span>             <span class=c1>; End of function mystery3</span>
</span></span></code></pre></td></tr></table></div></div><p>It is provided in Thumb mode, as we can see from the instruction width, which is consistently 16 bits. Furthermore, the decompilation is greatly facilitated thanks to the lack of any conditional statements. Any kind of NULL-checks, for instance, are omitted.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-02-practical-reverse-engineering-exercise-solutions-page-79-exercise-3/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/practical-reverse-engineering/2017-12-02-practical-reverse-engineering-exercise-solutions-page-78-exercise-2/>Practical Reverse Engineering Exercise Solutions: Page 78 / Exercise 2</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>soffensive</a></span>&nbsp;<span class=post-publish>published on <time datetime=2017-12-02>2017-12-02</time></span>&nbsp;<span class=post-category>included in <a href=/categories/practical-reverse-engineering/><i class="far fa-folder fa-fw" aria-hidden=true></i>Practical Reverse Engineering</a></span></div><div class=content><p>Exercise 2 of the ARM chapter has a rather short disassembly compared to the first exercise. Again, we are tasked with the decompilation of the provided function <code>mystery2</code>.</p><p>The disassembly is as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=err>01:</span>             <span class=nf>mystery2</span>
</span></span><span class=line><span class=cl><span class=err>02:</span> <span class=err>28</span> <span class=nf>B1</span>         <span class=nv>CBZ</span>      <span class=nv>R0</span><span class=p>,</span> <span class=nv>loc_C672</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>03:</span> <span class=err>90</span> <span class=nf>F8</span> <span class=mi>63</span> <span class=mi>00</span>   <span class=nv>LDRB.W</span>   <span class=nv>R0</span><span class=p>,</span> <span class=p>[</span><span class=nv>R0</span><span class=p>,</span><span class=err>#</span><span class=mh>0x63</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=err>04:</span> <span class=err>00</span> <span class=err>38</span>         <span class=nf>SUBS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=err>05:</span> <span class=err>18</span> <span class=nf>BF</span>         <span class=nv>IT</span> <span class=nv>NE</span>
</span></span><span class=line><span class=cl><span class=err>06:</span> <span class=err>01</span> <span class=err>20</span>         <span class=nf>MOVNE</span>    <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>07:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>              <span class=nv>LR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>08:</span>             <span class=nf>loc_C672</span>
</span></span><span class=line><span class=cl><span class=err>09:</span> <span class=err>01</span> <span class=err>20</span>         <span class=nf>MOVS</span>     <span class=nv>R0</span><span class=p>,</span> <span class=err>#</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=err>10:</span> <span class=err>70</span> <span class=err>47</span>         <span class=nf>BX</span>              <span class=nv>LR</span>
</span></span><span class=line><span class=cl><span class=err>11:</span>             <span class=c1>; End of function mystery2</span>
</span></span></code></pre></td></tr></table></div></div><p>First of all, we notice that the function has been compiled in Thumb mode, as there are several instructions having a width of 16 bits, which is not possible in ARM mode. Furthermore, the instructions <code>CBZ</code> and <code>IT</code> are specific to Thumb mode and not available in ARM mode.</p></div><div class=post-footer><a href=/posts/practical-reverse-engineering/2017-12-02-practical-reverse-engineering-exercise-solutions-page-78-exercise-2/>Read More</a><div class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/arm/>ARM</a>,&nbsp;<a href=/tags/practical-reverse-engineering/>Practical Reverse Engineering</a></div></div></article><ul class=pagination><li class=page-item><span class=page-link><a href=/>1</a></span></li><li class=page-item><span class=page-link><a href=/page/2/>2</a></span></li><li class="page-item active"><span class=page-link><a href=/page/3/>3</a></span></li><li class=page-item><span class=page-link><a href=/page/4/>4</a></span></li><li class=page-item><span class=page-link><a href=/page/5/>5</a></span></li><li class=page-item><span class=page-link><a href=/page/6/>6</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},data:{"id-1":"Another blog about software security issues"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>